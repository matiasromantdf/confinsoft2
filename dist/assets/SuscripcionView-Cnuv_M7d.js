import{_ as C,aj as m,Z as i,b as t,$ as a,a8 as b,a2 as h,a1 as z,Y as x,ao as w,a6 as d,a7 as c,a0 as f,ad as S,h as l,a5 as M,av as _,a4 as o,al as y,af as n,ay as T,az as g,aA as v,ag as A,V as I,F as k,i as D,n as j,aD as B}from"./index-CUCF8Fp0.js";const V=new MercadoPago("APP_USR-542986ce-8be5-49a9-8fb9-99ac00e3be2f");V.bricks();const E={data(){return{url:"https://api-tpv.confinsoft.com/public",cargando:!1,cargandoPago:!1,cargandoText:"cargando suscripción...",suscripcion:{},walletCreated:!1}},setup(){return{usuario:z()}},mounted(){},methods:{test(){this.cargandoPago=!0;let r={tpv:this.usuario.tpv};h.post(this.url+"/"+this.usuario.tpv+"/comercio/pagarSuscripcion",r,{headers:{Authorization:this.usuario.token}}).then(e=>{console.log(e.data),V.bricks().create("wallet","wallet_container",{initialization:{preferenceId:e.data},customization:{texts:{valueProp:"smart_option"}}}).then(()=>{this.walletCreated=!0,this.cargandoPago=!1,this.$nextTick(()=>{setTimeout(()=>{const u=document.getElementById("wallet_container");u&&u.scrollIntoView({behavior:"smooth",block:"center"})},500)})}).catch(u=>{console.error("Error creando wallet:",u),this.cargandoPago=!1,this.$swal("Error","Hubo un problema al cargar la pasarela de pago. Por favor, intenta nuevamente.","error")})}).catch(e=>{console.log(e),this.cargandoPago=!1})},adherirseDA(){window.location.href="https://www.mercadopago.com.ar/subscriptions/checkout?preapproval_plan_id=2c93808490c3cfa40190ccdf376202c5"},formatearfecha(r){return new Date(r).toLocaleDateString()},formatearMoneda(r){return parseFloat(r).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")}},computed:{proximoVencimiento(){let r=new Date(this.usuario.comercio.vencimiento);return r.setMonth(r.getMonth()+1),r.toLocaleDateString()}}},N={class:"mb-2"},L={class:"mb-0"},R={class:"d-flex align-center mb-3"},F={key:0,class:"text-caption text-medium-emphasis"},U={key:1,class:"text-caption text-medium-emphasis"},q={class:"d-flex align-center mb-3"};function H(r,e,u,P,s,p){return i(),m("div",null,[t(b,null,{default:a(()=>[t(d,null,{default:a(()=>[t(c,null,{default:a(()=>[t(f,{elevation:"10",loading:s.cargando},{default:a(()=>[t(S,null,{default:a(()=>[...e[0]||(e[0]=[l("h2",null,"Suscripción",-1)])]),_:1}),t(M,null,{default:a(()=>[t(b,null,{default:a(()=>[t(d,null,{default:a(()=>[t(c,null,{default:a(()=>[t(_,{type:"info",variant:"tonal",class:"mb-4",icon:"mdi-information-outline"},{default:a(()=>[e[3]||(e[3]=l("div",{class:"text-h6 mb-2"},"Estado de tu Suscripción",-1)),l("p",N,[e[1]||(e[1]=l("strong",null,"Vencimiento actual:",-1)),o(" "+y(p.formatearfecha(P.usuario.comercio.vencimiento)),1)]),l("p",L,[e[2]||(e[2]=l("strong",null,"Costo de renovación:",-1)),o(" ARS$"+y(p.formatearMoneda(P.usuario.comercio.precio)),1)])]),_:1})]),_:1})]),_:1}),t(d,null,{default:a(()=>[t(c,null,{default:a(()=>[t(f,{variant:"outlined",class:"pa-4"},{default:a(()=>[l("div",R,[t(n,{color:"primary",class:"mr-2"},{default:a(()=>[...e[4]||(e[4]=[o("mdi-shield-check",-1)])]),_:1}),e[5]||(e[5]=l("h6",{class:"text-h6"},"Procesamiento Seguro",-1))]),t(T,{density:"compact",class:"bg-transparent"},{default:a(()=>[t(g,null,{prepend:a(()=>[t(n,{color:"success",size:"small"},{default:a(()=>[...e[6]||(e[6]=[o("mdi-check-circle",-1)])]),_:1})]),default:a(()=>[t(v,null,{default:a(()=>[...e[7]||(e[7]=[o("El pago se procesa automáticamente a través de ",-1),l("strong",null,"MercadoPago",-1)])]),_:1})]),_:1}),t(g,null,{prepend:a(()=>[t(n,{color:"success",size:"small"},{default:a(()=>[...e[8]||(e[8]=[o("mdi-check-circle",-1)])]),_:1})]),default:a(()=>[t(v,null,{default:a(()=>[...e[9]||(e[9]=[o("Tu suscripción se renueva inmediatamente después del pago",-1)])]),_:1})]),_:1}),t(g,null,{prepend:a(()=>[t(n,{color:"success",size:"small"},{default:a(()=>[...e[10]||(e[10]=[o("mdi-check-circle",-1)])]),_:1})]),default:a(()=>[t(v,null,{default:a(()=>[...e[11]||(e[11]=[o("Recibirás confirmación por email una vez completado el proceso",-1)])]),_:1})]),_:1}),t(g,null,{prepend:a(()=>[t(n,{color:"success",size:"small"},{default:a(()=>[...e[12]||(e[12]=[o("mdi-check-circle",-1)])]),_:1})]),default:a(()=>[t(v,null,{default:a(()=>[...e[13]||(e[13]=[o("Métodos de pago: Tarjeta de crédito/débito dinero en cuenta MP",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(A,null,{default:a(()=>[t(b,null,{default:a(()=>[t(d,{justify:"center"},{default:a(()=>[t(c,{cols:"12",md:"8",class:"text-center"},{default:a(()=>[t(I,{color:"primary",size:"large",variant:"elevated",loading:s.cargandoPago,disabled:s.cargandoPago,onClick:p.test,"prepend-icon":"mdi-credit-card",class:"mb-3"},{default:a(()=>[s.cargandoPago?(i(),m(k,{key:0},[o(" Preparando pago... ")],64)):(i(),m(k,{key:1},[o(" Renovar suscripción hasta el "+y(p.proximoVencimiento),1)],64))]),_:1},8,["loading","disabled","onClick"]),s.cargandoPago?(i(),m("div",F,[t(n,{size:"small",class:"mr-1"},{default:a(()=>[...e[14]||(e[14]=[o("mdi-loading mdi-spin",-1)])]),_:1}),e[15]||(e[15]=o(" Conectando con MercadoPago, por favor espera... ",-1))])):(i(),m("div",U," Al hacer clic se abrirá la pasarela de pago de MercadoPago "))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}),s.walletCreated&&!s.cargandoPago?(i(),x(d,{key:0,justify:"center",class:"my-4"},{default:a(()=>[t(c,{cols:"12",class:"text-center"},{default:a(()=>[t(n,{color:"primary",size:"x-large",style:{animation:"bounce 2s infinite"}},{default:a(()=>[...e[16]||(e[16]=[o(" mdi-arrow-down-circle ",-1)])]),_:1}),e[17]||(e[17]=l("div",{class:"text-body-2 font-weight-medium text-primary mt-2"}," Completa tu pago aquí abajo ",-1))]),_:1})]),_:1})):w("",!0),t(d,{justify:"center"},{default:a(()=>[t(c,{md:"8",sm:"12"},{default:a(()=>[l("div",{id:"wallet_container",style:j({display:s.cargandoPago?"none":"block"}),class:D({"wallet-highlight":s.walletCreated&&!s.cargandoPago})},null,6),s.cargandoPago?(i(),x(f,{key:0,variant:"outlined",class:"pa-4 text-center"},{default:a(()=>[t(B,{indeterminate:"",color:"primary",class:"mb-3"}),e[18]||(e[18]=l("div",{class:"text-body-2 font-weight-medium mb-2"},"Preparando pasarela de pago",-1)),e[19]||(e[19]=l("div",{class:"text-caption text-medium-emphasis"},"Conectando con MercadoPago...",-1))]),_:1})):w("",!0),s.walletCreated&&!s.cargandoPago?(i(),x(f,{key:1,variant:"outlined",class:"mt-4 pa-4",color:"success",style:{animation:"slideIn 0.5s ease-out"}},{default:a(()=>[l("div",q,[t(n,{color:"success",class:"mr-2",size:"large"},{default:a(()=>[...e[20]||(e[20]=[o("mdi-check-circle",-1)])]),_:1}),e[21]||(e[21]=l("div",null,[l("div",{class:"text-h6 font-weight-bold text-success"},"¡Pasarela de pago lista!")],-1))]),t(_,{type:"info",variant:"tonal",density:"compact",icon:"mdi-information-outline"},{default:a(()=>[...e[22]||(e[22]=[o(" Una vez completado el pago, tu suscripción se renovará automáticamente. ",-1)])]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1})]),_:1})])}const Z=C(E,[["render",H],["__scopeId","data-v-b29b0b4e"]]);export{Z as default};
