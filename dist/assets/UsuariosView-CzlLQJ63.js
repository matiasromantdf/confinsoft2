import{_ as B,ak as c,Z as p,b as e,$ as a,aa as k,a1 as T,a2 as V,Y as h,ab as C,a6 as i,a7 as n,a0 as v,a5 as g,a4 as r,F as A,al as S,h as U,am as x,ah as w,af as E,a8 as N,ad as d,at as P,ai as _,V as m,m as y,au as F,a9 as z}from"./index-DQRk2oC9.js";const D={data(){return{url:"https://api-tpv.confinsoft.com/public",usuarios:[],cargando:!1,mensaje:!0,dialog:!1,dialogEditar:!1,nuevoUsuario:{nombre:"",username:"",password:""},guardandoNuevo:!1}},methods:{getUsuarios(){this.cargando=!0,V.get(this.url+"/"+this.usuario.tpv+"/usuarios/vendedores",{headers:{Authorization:this.usuario.token}}).then(s=>{this.usuarios=s.data}).catch(s=>{console.log(s)}).finally(()=>this.cargando=!1)},guardarNuevoUsuario(){this.guardandoNuevo=!0;let s={nombre:this.nuevoUsuario.nombre,email:this.nuevoUsuarioEmail,password:this.nuevoUsuario.password};if(!s.nombre||!s.password){this.$swal("Error","El nombre y la contraseña son obligatorios","error"),this.guardandoNuevo=!1;return}V.post(this.url+"/"+this.usuario.tpv+"/usuarios/vendedores",s,{headers:{Authorization:this.usuario.token}}).then(l=>{this.dialog=!1,this.$swal("Usuario creado","El usuario ha sido creado","success"),this.getUsuarios()}).catch(l=>{console.log(l)}).finally(()=>this.guardandoNuevo=!1)},editarUsuario(s){V.put(this.url+"/"+this.usuario.tpv+"/usuarios/vendedores/"+s.id,s,{headers:{Authorization:this.usuario.token}}).then(l=>{this.dialogEditar=!1,this.getUsuarios()}).catch(l=>{console.log(l)})},eliminarUsuario(s){this.$swal({title:"Eliminar usuario",text:"¿Está seguro que desea eliminar este usuario?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(l=>{l.isConfirmed&&V.delete(this.url+"/"+this.usuario.tpv+"/usuarios/vendedores/"+s.id,{headers:{Authorization:this.usuario.token}}).then(b=>{this.$swal("Usuario eliminado","El usuario ha sido eliminado","success"),this.getUsuarios()}).catch(b=>{console.log(b)})})}},created(){this.usuario.rol!=1&&this.$router.push({name:"no-autorizado"}),this.usuario.comercioTiene("facturacion")||this.$router.push({name:"no-autorizado"}),this.getUsuarios()},setup(){return{usuario:T()}},computed:{nuevoUsuarioEmail(){let s=this.usuario.tpv;return this.nuevoUsuario.nombre.toLowerCase().replace(/\s+/g,"")+"-tpv_"+s}}};function G(s,l,b,L,u,f){return p(),c("div",null,[e(k,null,{default:a(()=>[e(i,null,{default:a(()=>[e(n,null,{default:a(()=>[e(v,{title:"Usuarios vendedores",loading:u.cargando},{default:a(()=>[e(g,null,{default:a(()=>[...l[8]||(l[8]=[r(" En esta sección se pueden crear, editar y eliminar usuarios vendedores. Estos usuarios van a tener restricciones de acceso a funciones sensibles de la aplicación, como la gestión de productos. Sólo podrán realizar ventas y ver ciertos reportes. ",-1)])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}),u.cargando?C("",!0):(p(),h(i,{key:0,class:"d-flex"},{default:a(()=>[e(n,{class:"d-flex"},{default:a(()=>[(p(!0),c(A,null,S(u.usuarios,o=>(p(),h(v,{class:"ml-2",key:o.id,width:"200px",elevation:"15"},{prepend:a(()=>[e(F,{color:"blue-darken-2"},{default:a(()=>[e(z,{icon:"mdi-account"})]),_:1})]),append:a(()=>[...l[9]||(l[9]=[])]),default:a(()=>[e(g,null,{default:a(()=>[U("p",null,[l[10]||(l[10]=U("strong",null,"Usuario:",-1)),r(" "+x(o.email),1)]),U("p",null,[l[11]||(l[11]=U("strong",null,"Nombre:",-1)),r(" "+x(o.nombre),1)])]),_:2},1024),e(w,null,{default:a(()=>[e(E,{modelValue:u.dialogEditar,"onUpdate:modelValue":l[1]||(l[1]=t=>u.dialogEditar=t),"max-width":"290"},{activator:a(({props:t})=>[e(m,y({color:"blue darken-1"},{ref_for:!0},t),{default:a(()=>[...l[12]||(l[12]=[r("Editar",-1)])]),_:1},16)]),default:a(()=>[e(v,null,{default:a(()=>[e(N,{class:"headline"},{default:a(()=>[...l[13]||(l[13]=[r("Editar usuario",-1)])]),_:1}),e(g,null,{default:a(()=>[e(i,null,{default:a(()=>[e(n,null,{default:a(()=>[e(d,{label:"Nombre",variant:"outlined","hide-details":"",modelValue:o.nombre,"onUpdate:modelValue":t=>o.nombre=t},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(i,null,{default:a(()=>[e(n,null,{default:a(()=>[e(d,{label:"Usuario",variant:"outlined","hide-details":"",modelValue:o.email,"onUpdate:modelValue":t=>o.email=t},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(i,null,{default:a(()=>[e(n,null,{default:a(()=>[e(P,{label:"Cambiar contraseña",modelValue:o.cambiarPassword,"onUpdate:modelValue":t=>o.cambiarPassword=t,"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(i,null,{default:a(()=>[e(n,null,{default:a(()=>[e(d,{label:"password",variant:"outlined",type:"password",hint:"",modelValue:o.password,"onUpdate:modelValue":t=>o.password=t,disabled:!o.cambiarPassword},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(w,null,{default:a(()=>[e(_),e(m,{color:"blue darken-1",text:"",onClick:l[0]||(l[0]=t=>u.dialogEditar=!1)},{default:a(()=>[...l[14]||(l[14]=[r("Cerrar",-1)])]),_:1}),e(m,{color:"green darken-1",text:"",onClick:t=>f.editarUsuario(o)},{default:a(()=>[...l[15]||(l[15]=[r("Guardar",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"]),e(m,{color:"red",onClick:t=>f.eliminarUsuario(o)},{default:a(()=>[...l[16]||(l[16]=[r("Eliminar",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),u.usuarios.length<2?(p(),h(v,{key:0,class:"ml-2",width:"200px",elevation:"15"},{default:a(()=>[e(g,null,{default:a(()=>[e(k,null,{default:a(()=>[e(i,null,{default:a(()=>[e(n,null,{default:a(()=>[e(E,{modelValue:u.dialog,"onUpdate:modelValue":l[7]||(l[7]=o=>u.dialog=o),"max-width":"290"},{activator:a(({props:o})=>[e(z,y({color:"primary"},o,{size:"100"}),{default:a(()=>[...l[17]||(l[17]=[r("mdi-account-plus",-1)])]),_:1},16)]),default:a(()=>[e(v,null,{default:a(()=>[e(N,{class:"headline"},{default:a(()=>[...l[18]||(l[18]=[r("Nuevo usuario",-1)])]),_:1}),e(g,null,{default:a(()=>[e(i,null,{default:a(()=>[e(n,null,{default:a(()=>[e(d,{label:"Nombre",variant:"outlined","hide-details":"",modelValue:u.nuevoUsuario.nombre,"onUpdate:modelValue":l[2]||(l[2]=o=>u.nuevoUsuario.nombre=o)},null,8,["modelValue"])]),_:1})]),_:1}),e(i,null,{default:a(()=>[e(n,null,{default:a(()=>[e(d,{label:"Usuario",variant:"outlined","hide-details":"",modelValue:f.nuevoUsuarioEmail,"onUpdate:modelValue":l[3]||(l[3]=o=>f.nuevoUsuarioEmail=o),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i),e(i,null,{default:a(()=>[e(n,null,{default:a(()=>[e(d,{label:"password",variant:"outlined",type:"password",hint:"ingrese con atención la contraseña",modelValue:u.nuevoUsuario.password,"onUpdate:modelValue":l[4]||(l[4]=o=>u.nuevoUsuario.password=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(_),e(m,{color:"blue darken-1",text:"",onClick:l[5]||(l[5]=o=>u.dialog=!1)},{default:a(()=>[...l[19]||(l[19]=[r("Cerrar",-1)])]),_:1}),e(m,{color:"green darken-1",text:"",onClick:l[6]||(l[6]=o=>f.guardarNuevoUsuario()),loading:u.guardandoNuevo},{default:a(()=>[...l[20]||(l[20]=[r("Guardar",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):C("",!0)]),_:1})]),_:1}))]),_:1})])}const q=B(D,[["render",G]]);export{q as default};
