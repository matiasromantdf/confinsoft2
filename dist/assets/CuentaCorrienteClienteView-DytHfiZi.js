import{aa as v,ax as h,ac as V,h as e,ad as o,an as d,af as g,ag as m,ak as s,al as n,ae as C,aj as b,l as p,aE as x,aF as w,ap as S,aq as c,av as _,z as f,ai as r,ar as k,at as y,az as B}from"./index-vTzWlssv.js";const D={data(){return{completo:!0,cliente:{},url:"https://api-tpv.confinsoft.com/public",cargando:!1,cargandoText:"cargando movimientos...",conceptos:[{title:"Pago",value:"pago"},{title:"Retiro",value:"retiro"}],concepto:"",importe:0,observaciones:"",headers:[{title:"Fecha",value:"fecha"},{title:"Concepto",value:"movimiento"},{title:"Monto",value:"monto"},{title:"Saldo",value:"saldo"},{title:"Detalles",value:"detalles"}],conceptoRules:[l=>!!l||"El concepto es requerido"],importeRules:[l=>!!l||"El importe es requerido",l=>l>=0||"El importe debe ser mayor a 0"]}},methods:{getClienteYCuenta(){this.cargando=!0,m.get(this.url+"/"+this.usuario.tpv+"/clientes/"+this.$route.params.id+"/cuenta",{headers:{Authorization:this.usuario.token}}).then(l=>{this.cliente=l.data}).catch(l=>{console.log(l)}).finally(()=>this.cargando=!1)},saveMovimiento(){this.completo&&this.$swal({title:"¿Estás seguro?",text:"¿Deseas guardar el movimiento?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, guardar",cancelButtonText:"Cancelar"}).then(l=>{l.isConfirmed&&m.post(this.url+"/"+this.usuario.tpv+"/cuentas",{cliente_id:this.cliente.id,movimiento:this.concepto,monto:this.importe,detalles:this.observaciones},{headers:{Authorization:this.usuario.token}}).then(t=>{this.getClienteYCuenta(),this.concepto="",this.importe=0,this.observaciones="",this.completo=!1}).catch(t=>{console.log(t)})})},formatearFecha(l){return new Date(l).toLocaleDateString()}},setup(){return{usuario:g()}},mounted(){this.usuario.rol!=1&&this.$router.push("/no-autorizado"),this.cliente=this.$route.params.id,this.getClienteYCuenta()}};function F(l,t,T,E,a,u){return V(),h("div",null,[e(d,null,{default:o(()=>[e(s,null,{default:o(()=>[e(n,null,{default:o(()=>[e(C,{title:"Cuenta corriente de "+a.cliente.nombre,loading:a.cargando},{default:o(()=>[e(b,null,{default:o(()=>[e(d,null,{default:o(()=>[e(s,{class:"elevation-1 rounded-sm border"},{default:o(()=>[e(n,null,{default:o(()=>[t[9]||(t[9]=p("h4",null,"Añadir un registro a la cuenta",-1)),t[10]||(t[10]=p("br",null,null,-1)),e(x,{onSubmit:t[5]||(t[5]=w(i=>u.saveMovimiento(),["prevent"])),modelValue:a.completo,"onUpdate:modelValue":t[6]||(t[6]=i=>a.completo=i),"validate-on":"blur"},{default:o(()=>[e(s,null,{default:o(()=>[e(n,{cols:"12",md:"6"},{default:o(()=>[e(S,{items:a.conceptos,label:"Concepto",modelValue:a.concepto,"onUpdate:modelValue":t[0]||(t[0]=i=>a.concepto=i),variant:"outlined",rules:a.conceptoRules},null,8,["items","modelValue","rules"])]),_:1}),e(n,{cols:"12",md:"6"},{default:o(()=>[e(c,{label:"Importe",modelValue:a.importe,"onUpdate:modelValue":t[1]||(t[1]=i=>a.importe=i),variant:"outlined",rules:a.importeRules,type:"number",onFocus:t[2]||(t[2]=i=>a.importe="")},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(s,null,{default:o(()=>[e(n,null,{default:o(()=>[e(c,{label:"Observaciones",modelValue:a.observaciones,"onUpdate:modelValue":t[3]||(t[3]=i=>a.observaciones=i),variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,null,{default:o(()=>[e(_),e(n,{md:"2",sm:"6"},{default:o(()=>[e(f,{type:"reset",color:"",variant:"tonal",onClick:t[4]||(t[4]=i=>l.$router.back()),width:"100%"},{default:o(()=>[...t[7]||(t[7]=[r("volver",-1)])]),_:1})]),_:1}),e(n,{md:"2",sm:"6"},{default:o(()=>[e(f,{type:"submit",color:"primary",variant:"tonal",width:"100%"},{default:o(()=>[...t[8]||(t[8]=[r("Guardar",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,null,{default:o(()=>[e(n,null,{default:o(()=>[e(k),e(y,{headers:a.headers,items:a.cliente.movimientos,"items-per-page":5,"no-data-text":"Sin Movimientos","items-per-page-text":"filas"},{"item.fecha":o(({item:i})=>[r(B(u.formatearFecha(i.created_at)),1)]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["title","loading"])]),_:1})]),_:1})]),_:1})])}const z=v(D,[["render",F]]);export{z as default};
