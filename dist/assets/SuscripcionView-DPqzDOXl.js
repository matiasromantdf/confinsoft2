import{aa as z,ax as c,ac as r,h as t,ad as a,an as _,ag as M,af as A,ak as u,al as p,ab as P,ao as v,ae as b,am as I,l as o,aj as T,aI as k,ai as l,az as f,v as m,aL as j,aM as x,aN as y,au as R,z as w,F as V,aQ as h,o as N,n as B,w as D}from"./index-BVRtfBcM.js";const C=new MercadoPago("APP_USR-542986ce-8be5-49a9-8fb9-99ac00e3be2f");C.bricks();const E={data(){return{url:"https://api-tpv.confinsoft.com/public",cargando:!1,cargandoPago:!1,cargandoText:"cargando suscripción...",suscripcion:{},walletCreated:!1,periodosSeleccionados:0}},setup(){return{usuario:A()}},mounted(){},methods:{pagarSuscripcion(i){this.cargandoPago=!0,this.periodosSeleccionados=i;let e={tpv:this.usuario.tpv,periodos:i};M.post(this.url+"/"+this.usuario.tpv+"/comercio/pagarSuscripcion",e,{headers:{Authorization:this.usuario.token}}).then(g=>{console.log(g.data),C.bricks().create("wallet","wallet_container",{initialization:{preferenceId:g.data},customization:{texts:{valueProp:"smart_option"}}}).then(()=>{this.walletCreated=!0,this.cargandoPago=!1,this.$nextTick(()=>{setTimeout(()=>{const n=document.getElementById("wallet_container");n&&n.scrollIntoView({behavior:"smooth",block:"center"})},500)})}).catch(n=>{console.error("Error creando wallet:",n),this.cargandoPago=!1,this.$swal("Error","Hubo un problema al cargar la pasarela de pago. Por favor, intenta nuevamente.","error")})}).catch(g=>{console.log(g),this.cargandoPago=!1})},adherirseDA(){window.location.href="https://www.mercadopago.com.ar/subscriptions/checkout?preapproval_plan_id=2c93808490c3cfa40190ccdf376202c5"},formatearfecha(i){return new Date(i).toLocaleDateString()},formatearMoneda(i){return parseFloat(i).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")}},computed:{proximoVencimiento(){if(!this.periodosSeleccionados)return"";let i=new Date(this.usuario.comercio.vencimiento);return i.setMonth(i.getMonth()+this.periodosSeleccionados),i.toLocaleDateString()}}},L={class:"mb-2"},F={class:"mb-0"},U={class:"d-flex align-center mb-3"},q={key:1},H={class:"text-caption"},Q={class:"position-relative d-inline-block",style:{width:"100%"}},G={key:1},J={class:"text-caption"},K={class:"text-decoration-line-through"},O={class:"ml-2 font-weight-bold"},W={key:0,class:"text-caption text-medium-emphasis"},X={key:1,class:"text-caption text-medium-emphasis"},Y={key:0,class:"mt-3"},Z={class:"d-flex align-center mb-3"};function $(i,e,g,n,s,d){return r(),c("div",null,[t(_,null,{default:a(()=>[t(u,null,{default:a(()=>[t(p,null,{default:a(()=>[t(b,{elevation:"10",loading:s.cargando},{default:a(()=>[t(I,null,{default:a(()=>[...e[2]||(e[2]=[o("h2",null,"Suscripción",-1)])]),_:1}),t(T,null,{default:a(()=>[t(_,null,{default:a(()=>[t(u,null,{default:a(()=>[t(p,null,{default:a(()=>[t(k,{type:"info",variant:"tonal",class:"mb-4",icon:"mdi-information-outline"},{default:a(()=>[e[5]||(e[5]=o("div",{class:"text-h6 mb-2"},"Estado de tu Suscripción",-1)),o("p",L,[e[3]||(e[3]=o("strong",null,"Vencimiento actual:",-1)),l(" "+f(d.formatearfecha(n.usuario.comercio.vencimiento)),1)]),o("p",F,[e[4]||(e[4]=o("strong",null,"Costo de renovación:",-1)),l(" ARS$"+f(d.formatearMoneda(n.usuario.comercio.precio)),1)])]),_:1})]),_:1})]),_:1}),t(u,null,{default:a(()=>[t(p,null,{default:a(()=>[t(b,{variant:"outlined",class:"pa-4"},{default:a(()=>[o("div",U,[t(m,{color:"primary",class:"mr-2"},{default:a(()=>[...e[6]||(e[6]=[l("mdi-shield-check",-1)])]),_:1}),e[7]||(e[7]=o("h6",{class:"text-h6"},"Procesamiento Seguro",-1))]),t(j,{density:"compact",class:"bg-transparent"},{default:a(()=>[t(x,null,{prepend:a(()=>[t(m,{color:"success",size:"small"},{default:a(()=>[...e[8]||(e[8]=[l("mdi-check-circle",-1)])]),_:1})]),default:a(()=>[t(y,null,{default:a(()=>[...e[9]||(e[9]=[l("El pago se procesa automáticamente a través de ",-1),o("strong",null,"MercadoPago",-1)])]),_:1})]),_:1}),t(x,null,{prepend:a(()=>[t(m,{color:"success",size:"small"},{default:a(()=>[...e[10]||(e[10]=[l("mdi-check-circle",-1)])]),_:1})]),default:a(()=>[t(y,null,{default:a(()=>[...e[11]||(e[11]=[l("Tu suscripción se renueva inmediatamente después del pago",-1)])]),_:1})]),_:1}),t(x,null,{prepend:a(()=>[t(m,{color:"success",size:"small"},{default:a(()=>[...e[12]||(e[12]=[l("mdi-check-circle",-1)])]),_:1})]),default:a(()=>[t(y,null,{default:a(()=>[...e[13]||(e[13]=[l("Recibirás confirmación por email una vez completado el proceso",-1)])]),_:1})]),_:1}),t(x,null,{prepend:a(()=>[t(m,{color:"success",size:"small"},{default:a(()=>[...e[14]||(e[14]=[l("mdi-check-circle",-1)])]),_:1})]),default:a(()=>[t(y,null,{default:a(()=>[...e[15]||(e[15]=[l("Métodos de pago: Tarjeta de crédito/débito dinero en cuenta MP",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(R,null,{default:a(()=>[t(_,null,{default:a(()=>[t(u,{justify:"center",class:"text-center"},{default:a(()=>[t(p,{cols:"12",md:"6",class:"text-center"},{default:a(()=>[t(w,{color:"primary",size:"large",variant:"elevated",loading:s.cargandoPago,disabled:s.cargandoPago,onClick:e[0]||(e[0]=S=>d.pagarSuscripcion(1)),"prepend-icon":"mdi-credit-card",block:""},{default:a(()=>[s.cargandoPago?(r(),c(V,{key:0},[l(" Preparando pago... ")],64)):(r(),c("div",q,[e[16]||(e[16]=o("div",null,"Pagar 1 mes",-1)),o("div",H,"ARS$ "+f(d.formatearMoneda(n.usuario.comercio.precio)),1)]))]),_:1},8,["loading","disabled"])]),_:1}),t(p,{cols:"12",md:"6",class:"text-center"},{default:a(()=>[o("div",Q,[t(h,{color:"black",size:"small",class:"discount-badge"},{default:a(()=>[...e[17]||(e[17]=[l(" 10% descuento ",-1)])]),_:1}),t(w,{color:"primary",size:"large",variant:"elevated",loading:s.cargandoPago,disabled:s.cargandoPago,onClick:e[1]||(e[1]=S=>d.pagarSuscripcion(3)),"prepend-icon":"mdi-credit-card-multiple",block:""},{default:a(()=>[s.cargandoPago?(r(),c(V,{key:0},[l(" Preparando pago... ")],64)):(r(),c("div",G,[e[18]||(e[18]=o("div",null,"Pagar 3 meses",-1)),o("div",J,[o("span",K,"ARS$ "+f(d.formatearMoneda(n.usuario.comercio.precio*3)),1),o("span",O,"ARS$ "+f(d.formatearMoneda(n.usuario.comercio.precio*3*.9)),1)])]))]),_:1},8,["loading","disabled"])])]),_:1})]),_:1}),t(u,{justify:"center",class:"mt-3",align:"center"},{default:a(()=>[s.cargandoPago?(r(),c("div",W,[t(m,{size:"small",class:"mr-1"},{default:a(()=>[...e[19]||(e[19]=[l("mdi-loading mdi-spin",-1)])]),_:1}),e[20]||(e[20]=l(" Conectando con MercadoPago, por favor espera... ",-1))])):(r(),c("div",X," Al hacer clic se abrirá la pasarela de pago de MercadoPago "))]),_:1}),t(u,{justify:"center",align:"center"},{default:a(()=>[s.periodosSeleccionados?(r(),c("div",Y,[t(h,{color:"primary",variant:"tonal","prepend-icon":"mdi-calendar-check"},{default:a(()=>[l(" Renovar hasta el "+f(d.proximoVencimiento),1)]),_:1})])):v("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"]),s.walletCreated&&!s.cargandoPago?(r(),P(u,{key:0,justify:"center",class:"my-4"},{default:a(()=>[t(p,{cols:"12",class:"text-center"},{default:a(()=>[t(m,{color:"primary",size:"x-large",style:{animation:"bounce 2s infinite"}},{default:a(()=>[...e[21]||(e[21]=[l(" mdi-arrow-down-circle ",-1)])]),_:1}),e[22]||(e[22]=o("div",{class:"text-body-2 font-weight-medium text-primary mt-2"}," Completa tu pago aquí abajo ",-1))]),_:1})]),_:1})):v("",!0),t(u,{justify:"center"},{default:a(()=>[t(p,{md:"8",sm:"12"},{default:a(()=>[o("div",{id:"wallet_container",style:B({display:s.cargandoPago?"none":"block"}),class:N({"wallet-highlight":s.walletCreated&&!s.cargandoPago})},null,6),s.cargandoPago?(r(),P(b,{key:0,variant:"outlined",class:"pa-4 text-center"},{default:a(()=>[t(D,{indeterminate:"",color:"primary",class:"mb-3"}),e[23]||(e[23]=o("div",{class:"text-body-2 font-weight-medium mb-2"},"Preparando pasarela de pago",-1)),e[24]||(e[24]=o("div",{class:"text-caption text-medium-emphasis"},"Conectando con MercadoPago...",-1))]),_:1})):v("",!0),s.walletCreated&&!s.cargandoPago?(r(),P(b,{key:1,variant:"outlined",class:"mt-4 pa-4",color:"success",style:{animation:"slideIn 0.5s ease-out"}},{default:a(()=>[o("div",Z,[t(m,{color:"success",class:"mr-2",size:"large"},{default:a(()=>[...e[25]||(e[25]=[l("mdi-check-circle",-1)])]),_:1}),e[26]||(e[26]=o("div",null,[o("div",{class:"text-h6 font-weight-bold text-success"},"¡Pasarela de pago lista! ")],-1))]),t(k,{type:"info",variant:"tonal",density:"compact",icon:"mdi-information-outline"},{default:a(()=>[...e[27]||(e[27]=[l(" Una vez completado el pago, tu suscripción se renovará automáticamente. ",-1)])]),_:1})]),_:1})):v("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}const ae=z(E,[["render",$],["__scopeId","data-v-31bdc2f9"]]);export{ae as default};
