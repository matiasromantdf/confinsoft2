import{_ as N,aj as b,Z as f,b as e,$ as a,a8 as w,a1 as z,a2 as V,Y as h,ao as k,a6 as i,a7 as d,a0 as p,a5 as v,a4 as r,F as B,ak as A,al as T,ag as c,ac as C,ad as x,aa as g,at as S,ah as E,V as n,m as _,au as P,af as y}from"./index-DbTXfS4c.js";const F={data(){return{url:"https://api-tpv.confinsoft.com/public",usuarios:[],cargando:!1,mensaje:!0,dialog:!1,dialogEditar:!1,nuevoUsuario:{nombre:"",username:"",password:""},guardandoNuevo:!1}},methods:{getUsuarios(){this.cargando=!0,V.get(this.url+"/"+this.usuario.tpv+"/usuarios/vendedores",{headers:{Authorization:this.usuario.token}}).then(u=>{this.usuarios=u.data}).catch(u=>{console.log(u)}).finally(()=>this.cargando=!1)},guardarNuevoUsuario(){this.guardandoNuevo=!0;let u={nombre:this.nuevoUsuario.nombre,email:this.nuevoUsuarioEmail,password:this.nuevoUsuario.password};V.post(this.url+"/"+this.usuario.tpv+"/usuarios/vendedores",u,{headers:{Authorization:this.usuario.token}}).then(l=>{this.dialog=!1,this.$swal("Usuario creado","El usuario ha sido creado","success"),this.getUsuarios()}).catch(l=>{console.log(l)}).finally(()=>this.guardandoNuevo=!1)},editarUsuario(u){V.put(this.url+"/"+this.usuario.tpv+"/usuarios/vendedores/"+u.id,u,{headers:{Authorization:this.usuario.token}}).then(l=>{this.dialogEditar=!1,this.getUsuarios()}).catch(l=>{console.log(l)})},eliminarUsuario(u){this.$swal({title:"Eliminar usuario",text:"¿Está seguro que desea eliminar este usuario?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(l=>{l.isConfirmed&&V.delete(this.url+"/"+this.usuario.tpv+"/usuarios/vendedores/"+u.id,{headers:{Authorization:this.usuario.token}}).then(U=>{this.$swal("Usuario eliminado","El usuario ha sido eliminado","success"),this.getUsuarios()}).catch(U=>{console.log(U)})})}},created(){this.usuario.rol!=1&&this.$router.push({name:"no-autorizado"}),this.getUsuarios()},setup(){return{usuario:z()}},computed:{nuevoUsuarioEmail(){let u=this.usuario.tpv;return this.nuevoUsuario.nombre.toLowerCase().replace(/\s+/g,"")+"@tpv"+u+".com"}}};function j(u,l,U,D,s,m){return f(),b("div",null,[e(w,null,{default:a(()=>[e(i,null,{default:a(()=>[e(d,null,{default:a(()=>[e(p,{title:"Usuarios vendedores",loading:s.cargando},{default:a(()=>[e(v,null,{default:a(()=>[...l[8]||(l[8]=[r(" En esta sección se pueden crear, editar y eliminar usuarios vendedores. Estos usuarios van a tener restricciones de acceso a funciones sensibles de la aplicación, como la gestión de productos. Sólo podrán realizar ventas y ver ciertos reportes. ",-1)])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}),s.cargando?k("",!0):(f(),h(i,{key:0,class:"d-flex"},{default:a(()=>[e(d,{class:"d-flex"},{default:a(()=>[(f(!0),b(B,null,A(s.usuarios,o=>(f(),h(p,{class:"ml-2",key:o.id,width:"200px",elevation:"15"},{prepend:a(()=>[e(P,{color:"blue-darken-2"},{default:a(()=>[e(y,{icon:"mdi-account"})]),_:1})]),append:a(()=>[...l[9]||(l[9]=[r(" Usuario ",-1)])]),default:a(()=>[e(v,null,{default:a(()=>[r(T(o.email),1)]),_:2},1024),e(c,null,{default:a(()=>[e(C,{modelValue:s.dialogEditar,"onUpdate:modelValue":l[1]||(l[1]=t=>s.dialogEditar=t),"max-width":"290"},{activator:a(({props:t})=>[e(n,_({color:"blue darken-1"},{ref_for:!0},t),{default:a(()=>[...l[10]||(l[10]=[r("Editar",-1)])]),_:1},16)]),default:a(()=>[e(p,null,{default:a(()=>[e(x,{class:"headline"},{default:a(()=>[...l[11]||(l[11]=[r("Editar usuario",-1)])]),_:1}),e(v,null,{default:a(()=>[e(i,null,{default:a(()=>[e(d,null,{default:a(()=>[e(g,{label:"Usuario",variant:"outlined","hide-details":"",modelValue:o.email,"onUpdate:modelValue":t=>o.email=t},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(i,null,{default:a(()=>[e(d,null,{default:a(()=>[e(S,{label:"Cambiar contraseña",modelValue:o.cambiarPassword,"onUpdate:modelValue":t=>o.cambiarPassword=t,"hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(i,null,{default:a(()=>[e(d,null,{default:a(()=>[e(g,{label:"password",variant:"outlined",type:"password",hint:"",modelValue:o.password,"onUpdate:modelValue":t=>o.password=t,disabled:!o.cambiarPassword},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(c,null,{default:a(()=>[e(E),e(n,{color:"blue darken-1",text:"",onClick:l[0]||(l[0]=t=>s.dialogEditar=!1)},{default:a(()=>[...l[12]||(l[12]=[r("Cerrar",-1)])]),_:1}),e(n,{color:"green darken-1",text:"",onClick:t=>m.editarUsuario(o)},{default:a(()=>[...l[13]||(l[13]=[r("Guardar",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"]),e(n,{color:"red",onClick:t=>m.eliminarUsuario(o)},{default:a(()=>[...l[14]||(l[14]=[r("Eliminar",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),s.usuarios.length<2?(f(),h(p,{key:0,class:"ml-2",width:"200px",elevation:"15"},{default:a(()=>[e(v,null,{default:a(()=>[e(w,null,{default:a(()=>[e(i,null,{default:a(()=>[e(d,null,{default:a(()=>[e(C,{modelValue:s.dialog,"onUpdate:modelValue":l[7]||(l[7]=o=>s.dialog=o),"max-width":"290"},{activator:a(({props:o})=>[e(y,_({color:"primary"},o,{size:"100"}),{default:a(()=>[...l[15]||(l[15]=[r("mdi-account-plus",-1)])]),_:1},16)]),default:a(()=>[e(p,null,{default:a(()=>[e(x,{class:"headline"},{default:a(()=>[...l[16]||(l[16]=[r("Nuevo usuario",-1)])]),_:1}),e(v,null,{default:a(()=>[e(i,null,{default:a(()=>[e(d,null,{default:a(()=>[e(g,{label:"Nombre",variant:"outlined","hide-details":"",modelValue:s.nuevoUsuario.nombre,"onUpdate:modelValue":l[2]||(l[2]=o=>s.nuevoUsuario.nombre=o)},null,8,["modelValue"])]),_:1})]),_:1}),e(i,null,{default:a(()=>[e(d,null,{default:a(()=>[e(g,{label:"Usuario",variant:"outlined","hide-details":"",modelValue:m.nuevoUsuarioEmail,"onUpdate:modelValue":l[3]||(l[3]=o=>m.nuevoUsuarioEmail=o),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i),e(i,null,{default:a(()=>[e(d,null,{default:a(()=>[e(g,{label:"password",variant:"outlined",type:"password",hint:"ingrese con atención la contraseña",modelValue:s.nuevoUsuario.password,"onUpdate:modelValue":l[4]||(l[4]=o=>s.nuevoUsuario.password=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(E),e(n,{color:"blue darken-1",text:"",onClick:l[5]||(l[5]=o=>s.dialog=!1)},{default:a(()=>[...l[17]||(l[17]=[r("Cerrar",-1)])]),_:1}),e(n,{color:"green darken-1",text:"",onClick:l[6]||(l[6]=o=>m.guardarNuevoUsuario()),loading:s.guardandoNuevo},{default:a(()=>[...l[18]||(l[18]=[r("Guardar",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):k("",!0)]),_:1})]),_:1}))]),_:1})])}const L=N(F,[["render",j]]);export{L as default};
